# SMDAA_NET
This is an implementation of  Skeleton-guided Multi-scale Dual-coordinate Attention Aggregation Network for Retinal Blood Vessel Segmentation.Deep learning plays a pivotal role in retinal blood vessel segmentation for medical diagnosis. Despite their significant efficacy, these techniques face two major challenges. Firstly, they often neglect the severe class imbalance in fundus images, where thin vessels in the foreground are proportionally minimal. Secondly, they are susceptible to poor image quality and blurred vessel edges, resulting in discontinuities or breaks in vascular structures. In response, this paper proposes the Skeleton-guided Multi-scale Dual-coordinate Attention Aggregation (SMDAA) network for retinal vessel segmentation. SMDAA comprises three innovative modules: Dual-coordinate Attention (DCA), Unbalanced Pixel Amplifier (UPA), and Vessel Skeleton Guidance (VSG). DCA, integrating Multi-scale Coordinate Feature Aggregation (MCFA) and Scale Coordinate Attention Decoding (SCAD), meticulously analyzes vessel structures across various scales, adept at capturing intricate details, thereby significantly enhancing segmentation accuracy. To address class imbalance, we introduce UPA, dynamically allocating more attention to misclassified pixels, ensuring precise extraction of thin and small blood vessels. Moreover, to preserve vessel structure continuity, we integrate vessel anatomy and develop the VSG module to connect fragmented vessel segments. Additionally, a Feature-level Contrast (FCL) loss is introduced to capture subtle nuances within the same category, enhancing the fidelity of retinal blood vessel segmentation. Extensive experiments on three public datasets (DRIVE, STARE, and CHASE_DB1) demonstrate superior performance in comparison to current methods.  

![image](https://github.com/user-attachments/assets/61483455-1941-4fff-9e8c-4eb4c185c798)  
Fig. 1. Challenging instance in retinal vessel segmentation. (a) Fundus image, (b) Ground Truth, (c) MCDAU-Net [32], (d) LSRPR-Net [33] and (e) SMDAA (Ours).  

Firstly, a primary challenge lies in inadequate feature extraction: U-net may struggle to extract the necessary features from retinal images, especially in areas where blood vessel details are subtle. This limitation can lead to inaccurate segmentation. Moreover, achieving precise delineation of thin and slender vessels poses a significant challenge. These vessels are often overlooked or misrepresented, as illustrated by the green arrow in Fig. 1 (a). Secondly, these methodologies frequently encounter difficulties when dealing with images exhibiting low contrast or inconsistent quality, which are common occurrences in clinical settings. Consequently, segmentation continuity may be disrupted, as depicted by the blue arrow in Fig. 1 (a). Thirdly, the persistent issue of class imbalance between blood vessels (purple and yellow arrows in Fig. 1(b)) and background (red arrow in Fig. 1(b)), as well as between thick (purple arrow) and thin blood vessels (yellow arrow), remains a significant challenge. This imbalance can lead the model to bias towards predicting non-vessel regions during training, thereby impacting segmentation accuracy and hindering performance.
# Model
![image](https://github.com/user-attachments/assets/5771bf1a-3bbd-494b-8f13-209a193d426e)  
Fig. 2. shows our proposed SMDAA network. 
# Environment Configurationï¼š
* Python3.8
* Pytorch1.10
* Best trained with GPU
